"use strict";var WPFormsFormLocker=window.WPFormsFormLocker||function(u){var f={init:function(){u(f.ready)},ready:function(){f.validation(),f.initNameGroupsValidation()},validation:function(){void 0!==u.fn.validate&&u.validator.addMethod("unique",function(s,r,e,n){n="string"==typeof n&&n||"unique";var o,a=u(r),d=a.closest(".wpforms-field"),m=this.previousValue(r,n),i={action:"wpforms_form_locker_unique_answer",form_id:a.closest(".wpforms-form").data("formid"),field_id:d.data("field-id")},t=r.name;return d.hasClass("wpforms-field-name")?(s=f.getCombinedValue(d),t="wpforms[fields]["+i.field_id+"]"):a.hasClass("wpforms-smart-phone-field")&&(s=a.siblings('[name="'+(t="wpforms[fields]["+i.field_id+"]")+'"]').first().val()),i[t]=s,this.settings.messages[r.name]||(this.settings.messages[r.name]={}),m.originalMessage=m.originalMessage||this.settings.messages[r.name][n],this.settings.messages[r.name][n]=m.message,a=u.param(u.extend({data:s},(e="string"==typeof e?{url:e}:e).data)),m.old===a?m.valid:(m.old=a,(o=this).startRequest(r),u.ajax(u.extend(!0,{url:wpforms_form_locker.ajaxurl,type:"post",mode:"abort",port:"validate"+r.name,dataType:"json",data:i,context:o.currentForm,success:function(e){var a,i=!0===e||"true"===e,t=r.name.replace(/(\[[a-z]*\])$/g,"");o.settings.messages[r.name][n]=m.originalMessage,i?(a=o.formSubmitted,o.resetInternals(),o.toHide=o.errorsFor(r),o.formSubmitted=a,(o=f.updateValidatorLists(o,t,d,i)).showErrors()):(a={},e=e||o.defaultMessage(r,{method:n,parameters:s}),a[r.name]=m.message=e,(o=f.updateValidatorLists(o,t,d,i)).showErrors(a)),m.valid=i,o.stopRequest(r,i)}},e)),"pending")},wpforms_settings.val_unique)},initNameGroupsValidation:function(){u(".wpforms-validate").each(function(){var e=u(this),a=e.data("validator");u.extend(a.groups,f.getNameGroups(e))})},getCombinedValue:function(e){var a=[];return e.find("input[data-rule-unique]").each(function(){var e=u(this).val();wpforms.empty(e)||a.push(e)}),a.join(" ")},getNameGroups:function(e){var s={};return e.find(".wpforms-field.wpforms-field-name.wpforms-field-unique").each(function(e){var i=u(this),t=i.attr("id").replace("-container","")+"-field-group";u.each(["first","middle","last"],function(e,a){a=i.find(".wpforms-field-name-"+a).attr("name")||!1;a&&(s[a]=t)})}),s},updateValidatorLists:function(a,i,t,s){return u.each(a.invalid,function(e){e.indexOf(i)<0||(a.invalid[e]=!s,e=t.find('input[name="'+e+'"]'),s&&a.successList.push(e[0]))}),a}};return f}((document,window,jQuery));WPFormsFormLocker.init();